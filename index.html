<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Notion D-Day Widget</title>
    <style>
        /* Global Styles */
        body, html {
            margin: 0; padding: 0; width: 100%; height: 100%;
            background-color: transparent;
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Helvetica, Arial, sans-serif;
            display: flex; justify-content: center; align-items: center; overflow: hidden;
        }
        .container {
            display: flex; flex-direction: column; gap: 8px; align-items: flex-start;
        }
        /* Badge Styles */
        .badge {
            padding: 4px 8px; border-radius: 4px; font-size: 14px; font-weight: 500; line-height: 1.2; white-space: nowrap;
        }
        /* Notion Color Palette */
        .gray   { color: #9B9A97; background-color: #EBECED; }
        .brown  { color: #976D57; background-color: #F4EEEE; }
        .orange { color: #D9730D; background-color: #FAEBDD; }
        .yellow { color: #DFAB01; background-color: #FBF3DB; }
        .green  { color: #448361; background-color: #DDEDEA; }
        .blue   { color: #2383E2; background-color: #E0F1FF; }
        .purple { color: #6940A5; background-color: #EAE4F2; }
        .pink   { color: #C14C8A; background-color: #F4DFEB; }
        .red    { color: #D44C47; background-color: #FBE4E4; }
    </style>
</head>
<body>
    <div class="container">
        <div id="day-display" class="badge"></div>
        <div id="week-display" class="badge"></div>
    </div>

    <script>
        // ====================================================
        // CONFIGURATION
        // ====================================================
        const urlParams = new URLSearchParams(window.location.search);
        
        // 1. Target Date
        const targetDateStr = urlParams.get('date') || "2026-07-20"; 
        
        // 2. Display Toggles
        const showDays = urlParams.get('day') !== 'false'; 
        const showWeeks = urlParams.get('week') !== 'false'; 

        // 3. Color Overrides (Optional)
        // Options: gray, brown, orange, yellow, green, blue, purple, pink, red
        const dayColorOverride = urlParams.get('dayColor');
        const weekColorOverride = urlParams.get('weekColor');

        function updateDday() {
            const today = new Date();
            const target = new Date(targetDateStr);
            
            if (isNaN(target.getTime())) {
                document.getElementById("day-display").textContent = "Invalid Date";
                document.getElementById("day-display").className = "badge red";
                return;
            }

            today.setHours(0,0,0,0);
            target.setHours(0,0,0,0);

            const diffTime = target - today;
            const days = Math.ceil(diffTime / (1000 * 60 * 60 * 24)); 
            
            const dayEl = document.getElementById("day-display");
            const weekEl = document.getElementById("week-display");

            // --- Day Logic ---
            if (showDays) {
                dayEl.style.display = "block";
                let dText = "";
                let dClass = "green"; // Default color

                if (days > 0) {
                    dText = `${days} days left`;
                    dClass = "green";
                } else if (days === 0) {
                    dText = " D-Day!";
                    dClass = "red";
                } else {
                    dText = `${Math.abs(days)} days passed`;
                    dClass = "gray";
                }

                // Apply Override if exists
                if (dayColorOverride) dClass = dayColorOverride;

                dayEl.textContent = dText;
                dayEl.className = `badge ${dClass}`;
            } else {
                dayEl.style.display = "none";
            }

            // --- Week Logic ---
            if (showWeeks) {
                const weeks = Math.floor(days / 7);
                weekEl.style.display = "block";
                let wText = "";
                let wClass = "purple"; // Default color

                if (weeks < 0) {
                    wText = `${Math.abs(weeks)} weeks passed`;
                    wClass = "gray"; 
                } else if (weeks === 0) {
                    wText = "D-Week!";
                    wClass = "purple";
                } else {
                    wText = `${weeks} weeks left`;
                    wClass = "purple"; 
                }

                // Apply Override if exists
                if (weekColorOverride) wClass = weekColorOverride;

                weekEl.textContent = wText;
                weekEl.className = `badge ${wClass}`;
            } else {
                weekEl.style.display = "none";
            }
        }
        
        updateDday();
    </script>
</body>
</html>